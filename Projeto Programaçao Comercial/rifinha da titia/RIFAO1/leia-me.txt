Fiz alterações, nada difícil de entender.
Mudei a conexao. Quem for mexer, verifica e vê como faz. Não é difícil.